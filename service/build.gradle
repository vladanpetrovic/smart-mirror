buildscript {
    repositories {
        mavenCentral()
        maven { url gradlePluginsRepo }
        maven { url springReleaseRepo }
        maven { url springSnapshotRepo }
        maven { url springMilestoneRepo }
        maven { url 'http://repo.spring.io/plugins-release' }
    }
    dependencies {
        classpath 'org.springframework.boot:spring-boot-gradle-plugin:2.0.0.M7'
        classpath 'io.spring.gradle:dependency-management-plugin:1.0.4.RELEASE'
        classpath 'org.springframework.build.gradle:propdeps-plugin:0.0.7'
        classpath 'gradle.plugin.org.unbroken-dome.gradle-plugins:gradle-testsets-plugin:1.3.2'
    }
}

def springBootProjects = [
        project(':service:api:user'),
        project(':service:api:todo'),
        project(':service:api:remainder'),
        project(':service:api:weather')
]
def springProjects = springBootProjects + [
        project(':service:api-gateway')
]
def javaProjects = springProjects

def vJavaLang = '1.8'
configure(javaProjects) {
    apply plugin: 'java'
    apply from: "${gradleDir}/testing.gradle"
    apply from: "${gradleDir}/codeCoverage.gradle"
    apply from: "${gradleDir}/staticCodeAnalysis.gradle"

    targetCompatibility = vJavaLang
    sourceCompatibility = vJavaLang
}

configure(springProjects) {
    apply plugin: 'io.spring.dependency-management'

    repositories {
        mavenCentral()
        maven { url springReleaseRepo }
        maven { url springSnapshotRepo }
        maven { url springMilestoneRepo }
    }

    dependencies {
        compile 'org.projectlombok:lombok'
        compile 'org.slf4j:slf4j-api'
        testCompile 'junit:junit'
        testCompile 'org.hamcrest:hamcrest-library'
        testCompile 'org.mockito:mockito-core'
        testCompile 'org.objenesis:objenesis'
    }
}

configure(springBootProjects) {
    apply plugin: 'org.springframework.boot'

    group = 'com.neatlicity.service'

    dependencies {
        compile 'org.springframework.boot:spring-boot-starter'
        compile 'org.springframework.boot:spring-boot-starter-actuator'

        runtime 'org.springframework.boot:spring-boot-devtools'
        testCompile 'org.springframework.boot:spring-boot-starter-test'
        testCompile 'io.projectreactor:reactor-test'
    }
}